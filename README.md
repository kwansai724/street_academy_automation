# ã‚¹ãƒˆã‚¢ã‚«æ—¥ç¨‹è¿½åŠ ãƒ»å‰Šé™¤ è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«

é¢å€’ãªã‚¹ãƒˆã‚¢ã‚«ã®è¬›åº§æ—¥ç¨‹ã®ã€Œè¿½åŠ ã€ã¨ã€Œå‰Šé™¤ã€ã‚’ã€ã‚¯ãƒªãƒƒã‚¯æ“ä½œã§ç°¡å˜ã«è¡Œã†ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

## æ©Ÿèƒ½

### ğŸ“… æ—¥ç¨‹ã®è¿½åŠ 
2ã¤ã®æ–¹å¼ã§æ—¥ç¨‹ã‚’è¿½åŠ ã§ãã¾ã™ï¼š

#### 1. å€‹åˆ¥æ—¥ç¨‹è¿½åŠ 
- **æ©Ÿèƒ½**: æ—¥æ™‚ã‚’å€‹åˆ¥ã«æŒ‡å®šã—ã¦æ—¥ç¨‹ã‚’è¿½åŠ 
- **å…¥åŠ›å½¢å¼**: `æ—¥ä»˜ ã‚¿ãƒ–æ–‡å­— é–‹å§‹æ™‚é–“~çµ‚äº†æ™‚é–“`
- **ä¾‹**: 
  ```
  2025-08-27	14:00~15:30
  2025-08-28	12:00~14:00
  2025-08-29	19:00~21:00
  ```
- **ç‰¹å¾´**: è‡ªç”±ãªæ—¥æ™‚ã§æ—¥ç¨‹ã‚’è¨­å®šå¯èƒ½

#### 2. é€£ç¶šæ—¥ç¨‹è¿½åŠ 
- **æ©Ÿèƒ½**: æŒ‡å®šã—ãŸæœŸé–“ã«å¯¾ã—ã¦ã€8:00ã€œ22:00ã¾ã§ã®è¬›åº§ã‚’è‡ªå‹•ã§è¿½åŠ 
- **å…¥åŠ›**: é–‹å§‹æ—¥ã¨çµ‚äº†æ—¥ï¼ˆYYYY-MM-DDå½¢å¼ï¼‰
- **è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹æ™‚é–“å¸¯**: 
  - 8:00-9:00, 9:00-10:00, 10:00-11:00, ..., 22:00-23:00
- **ç‰¹å¾´**: æœŸé–“å†…ã®æ¯æ—¥ã«åŒã˜æ™‚é–“å¸¯ã®è¬›åº§ã‚’ä¸€æ‹¬ä½œæˆ

#### å…±é€šæ©Ÿèƒ½
- **è¤‡æ•°URLå¯¾å¿œ**: æ—¥ç¨‹è¿½åŠ ãƒšãƒ¼ã‚¸ã®URLã‚’æ”¹è¡ŒåŒºåˆ‡ã‚Šã§è¤‡æ•°æŒ‡å®šå¯èƒ½
- **ã‚ªãƒ³ãƒ©ã‚¤ãƒ³é–‹å‚¬**: è‡ªå‹•ã§ã€Œã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã€å½¢å¼ã‚’é¸æŠ
- **ç·Šæ€¥é€£çµ¡å…ˆ**: è¨­å®šã—ãŸé›»è©±ç•ªå·ã‚’è‡ªå‹•å…¥åŠ›

### ğŸ—‘ï¸ æ—¥ç¨‹ã®å‰Šé™¤
2ã¤ã®æ–¹å¼ã§æ—¥ç¨‹ã‚’å‰Šé™¤ã§ãã¾ã™ï¼š

#### 1. å€‹åˆ¥æ—¥ç¨‹å‰Šé™¤
- **æ©Ÿèƒ½**: æ—¥æ™‚ã‚’å€‹åˆ¥ã«æŒ‡å®šã—ã¦æ—¥ç¨‹ã‚’å‰Šé™¤
- **å…¥åŠ›**: è¬›åº§åï¼ˆè¤‡æ•°ã®å ´åˆã¯æ”¹è¡ŒåŒºåˆ‡ã‚Šï¼‰ã€æ—¥ç¨‹ãƒªã‚¹ãƒˆ
- **å…¥åŠ›å½¢å¼**: `æ—¥ä»˜ ã‚¿ãƒ–æ–‡å­— é–‹å§‹æ™‚é–“~çµ‚äº†æ™‚é–“`
- **ä¾‹**: 
  ```
  2025-08-27	14:00~15:30
  2025-08-28	12:00~14:00
  ```
- **ç‰¹å¾´**: è‡ªç”±ãªæ—¥æ™‚ã§æ—¥ç¨‹ã‚’å‰Šé™¤å¯èƒ½

#### 2. é€£ç¶šæ—¥ç¨‹å‰Šé™¤
- **æ©Ÿèƒ½**: æŒ‡å®šã—ãŸæœŸé–“ã®å¯¾è±¡è¬›åº§æ—¥ç¨‹ã‚’ä¸€æ‹¬å‰Šé™¤
- **å…¥åŠ›**: è¬›åº§åï¼ˆè¤‡æ•°ã®å ´åˆã¯æ”¹è¡ŒåŒºåˆ‡ã‚Šï¼‰ã€é–‹å§‹æ—¥ã€çµ‚äº†æ—¥
- **ç‰¹å¾´**: æœŸé–“å†…ã®æŒ‡å®šè¬›åº§ã®å…¨æ—¥ç¨‹ã‚’ä¸€æ‹¬å‰Šé™¤

#### å…±é€šæ©Ÿèƒ½
- **è¬›åº§åãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**: æŒ‡å®šã—ãŸè¬›åº§åã®ã¿ã‚’å‰Šé™¤å¯¾è±¡ã¨ã™ã‚‹
- **è¤‡æ•°è¬›åº§å¯¾å¿œ**: è¤‡æ•°ã®è¬›åº§åã‚’æ”¹è¡ŒåŒºåˆ‡ã‚Šã§æŒ‡å®šå¯èƒ½

## å°å…¥æ‰‹é †

### 1. ã€äº‹å‰æº–å‚™ã€‘ å¿…è¦ãªãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ãŠä½¿ã„ã®PCã«Pythonã¨é–¢é€£ãƒ„ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ãŠä½¿ã„ã®OSï¼ˆMacã¾ãŸã¯Windowsï¼‰ã«åˆã‚ã›ã¦æ‰‹é †ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

---
#### <img src="https://www.apple.com/favicon.ico" width="16"> Macãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘æ‰‹é †

##### 1-1. Homebrewã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèªã¨å®Ÿè¡Œ
Macç”¨ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ãƒ„ãƒ¼ãƒ«ã€ŒHomebrewã€ã‚’æº–å‚™ã—ã¾ã™ã€‚

ã¾ãšã€**ã‚¿ãƒ¼ãƒŸãƒŠãƒ«**ã‚’é–‹ãã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§HomebrewãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã‹ç¢ºèªã—ã¾ã™ã€‚
```sh
command -v brew
```
*   `/opt/homebrew/bin/brew` ã®ã‚ˆã†ãªãƒ‘ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°ã€**ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿**ã§ã™ã€‚æ¬¡ã®æ‰‹é †ã«é€²ã‚“ã§ãã ã•ã„ã€‚
*   ä½•ã‚‚è¡¨ç¤ºã•ã‚Œãªã‘ã‚Œã°ã€**æœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**ã§ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã¦å®Ÿè¡Œã—ã€Homebrewã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚
    ```sh
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    ```

##### 1-2. Pythonã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèªã¨å®Ÿè¡Œ
æ¬¡ã«ã€Homebrewã‚’ä½¿ã£ã¦Pythonã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

ã¾ãšã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§PythonãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã‹ç¢ºèªã—ã¾ã™ã€‚
```bash
python3 --version
```
*   `Python 3.x.x` ã®ã‚ˆã†ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°ã€**ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿**ã§ã™ã€‚æ¬¡ã®ã€Œ1-3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã®æº–å‚™ã€ã«é€²ã‚“ã§ãã ã•ã„ã€‚
*   `command not found` ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚Œã°ã€**æœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**ã§ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§Pythonã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚
    ```bash
    brew install python3
    ```
    å®Œäº†ã—ãŸã‚‰ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ä¸€åº¦å®Œå…¨ã«çµ‚äº†ã—ã€å†èµ·å‹•ã—ã¦ãã ã•ã„ã€‚

##### 1-3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã®æº–å‚™ã¨ç§»å‹•
ä½œæ¥­ç”¨ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã€ãã“ã«ç§»å‹•ã—ã¾ã™ã€‚
```sh
# ä¾‹: ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã«ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆ
mkdir street_academy_automation
cd street_academy_automation
```
---
#### <img src="https://www.microsoft.com/favicon.ico" width="16"> Windowsãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘æ‰‹é †

##### 1-1. Pythonã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèªã¨å®Ÿè¡Œ
ã¾ãšã€ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¾ãŸã¯PowerShellã§PythonãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã‹ç¢ºèªã—ã¾ã™ã€‚
```powershell
python --version
```
*   `Python 3.x.x` ã®ã‚ˆã†ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°ã€**ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿**ã§ã™ã€‚æ¬¡ã®ã€Œ1-2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã®æº–å‚™ã€ã«é€²ã‚“ã§ãã ã•ã„ã€‚
*   `python ã¯ã€å†…éƒ¨ã‚³ãƒãƒ³ãƒ‰ã¾ãŸã¯å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰...` ãªã©ã®ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚Œã°ã€**æœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**ã§ã™ã€‚ä»¥ä¸‹ã®æ‰‹é †ã§Pythonã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚

1.  [Pythonå…¬å¼ã‚µã‚¤ãƒˆã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸](https://www.python.org/downloads/)ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚
2.  ã€ŒDownload Python 3.x.xã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
3.  ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã‚’èµ·å‹•ã—ã€**å¿…ãšã€ŒAdd Python 3.x to PATHã€ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ã‹ã‚‰**ã€ã€ŒInstall Nowã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

    ![Python for Windows Installer](https://docs.python.org/3/_images/win_installer.png)

##### 1-2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã®æº–å‚™ã¨ç§»å‹•
ä½œæ¥­ç”¨ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã€ãã“ã«ç§»å‹•ã—ã¾ã™ã€‚**ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**ã¾ãŸã¯**PowerShell**ã‚’é–‹ã„ã¦å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚
```powershell
# ä¾‹: ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã«ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆ
cd ~/Desktop
mkdir street_academy_automation
cd street_academy_automation
```
---
#### 1-4. ä»®æƒ³ç’°å¢ƒã®ä½œæˆã¨æœ‰åŠ¹åŒ– (Mac / Windowså…±é€š)

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå°‚ç”¨ã®ã‚¯ãƒªãƒ¼ãƒ³ãªç’°å¢ƒã‚’ä½œã‚Šã¾ã™ã€‚ã“ã‚Œä»¥é™ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€Macã¯**ã‚¿ãƒ¼ãƒŸãƒŠãƒ«**ã€Windowsã¯**ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**ã§å®Ÿè¡Œã—ã¾ã™ã€‚

â‘  **ä»®æƒ³ç’°å¢ƒã®ä½œæˆ** (ãƒ•ã‚©ãƒ«ãƒ€å†…ã§åˆå›ã®ã¿)
```sh
# Mac / Windows å…±é€š
python -m venv .venv
```

â‘¡ **ä»®æƒ³ç’°å¢ƒã®æœ‰åŠ¹åŒ–** (ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ã§ä½œæ¥­ã™ã‚‹éš›ã¯æ¯å›å®Ÿè¡Œ)
*   **Mac ã®å ´åˆ:**
    ```sh
    source .venv/bin/activate
    ```
*   **Windows ã®å ´åˆ:**
    ```powershell
    .\.venv\Scripts\activate
    ```
å®Ÿè¡Œå¾Œã€ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®è¡Œé ­ã« `(.venv)` ã¨è¡¨ç¤ºã•ã‚Œã‚Œã°OKã§ã™ã€‚

#### 1-5. å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« (Mac / Windowså…±é€š)
ä»®æƒ³ç’°å¢ƒãŒæœ‰åŠ¹ãªçŠ¶æ…‹ã§ã€è‡ªå‹•åŒ–ã«å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
```sh
# Mac / Windows å…±é€š
pip install flet playwright
playwright install
```

### 2. ã€ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆã€‘ `app.py` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨æ„ã™ã‚‹

å…ˆã»ã©ä½œæˆã—ãŸ`street_academy_automation`ãƒ•ã‚©ãƒ«ãƒ€å†…ã«ã€`app.py` ã¨ã„ã†åå‰ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®å†…å®¹ã‚’**ã™ã¹ã¦**ã‚³ãƒ”ãƒ¼ï¼†ãƒšãƒ¼ã‚¹ãƒˆã—ã¦ä¿å­˜ã—ã¦ãã ã•ã„ã€‚

```python
import flet as ft
import time
from datetime import date, timedelta
from playwright.sync_api import sync_playwright, expect
import threading
import os
import re

# èªè¨¼æƒ…å ±ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ (ã“ã®ã¾ã¾ã§OK)
AUTH_FILE_PATH = 'playwright_auth.json'

# â‘ ï¼šã‚ãªãŸã®ç·Šæ€¥é€£çµ¡å…ˆ(é›»è©±ç•ªå·)ã«æ›¸ãæ›ãˆã¦ãã ã•ã„
EMERGENCY_CONTACT = '090-1234-5678' 

# â‘¡ï¼šè¿½åŠ ã—ãŸã„æ™‚é–“å¸¯ (8æ™‚ã€œ22æ™‚ã§ã‚ˆã‘ã‚Œã°å¤‰æ›´ä¸è¦)
HOURS_TO_ADD = list(range(8, 23)) 

# å…±é€šè¨­å®š
BASE_URL = "https://www.street-academy.com"
ORGANIZER_SCHEDULE_URL = f"{BASE_URL}/dashboard/organizers/schedule_list"
TEACHER_SCHEDULE_URL = f"{BASE_URL}/dashboard/steachers/manage_class_dates"

class PlaywrightHelper:
    """Playwrightã®å…±é€šå‡¦ç†ã‚’æä¾›ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹"""
    
    @staticmethod
    def create_browser_context():
        """ãƒ–ãƒ©ã‚¦ã‚¶ã¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ä½œæˆ"""
        if not os.path.exists(AUTH_FILE_PATH):
            raise Exception("èªè¨¼ãƒ•ã‚¡ã‚¤ãƒ« 'playwright_auth.json' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚")
        
        playwright = sync_playwright().start()
        browser = playwright.chromium.launch(headless=False)
        context = browser.new_context(storage_state=AUTH_FILE_PATH)
        return playwright, browser, context
    
    @staticmethod
    def handle_403_forbidden(page, log_func, max_retries=3):
        """403 Forbiddenã‚¨ãƒ©ãƒ¼ã®å‡¦ç†"""
        for retry in range(max_retries):
            body_html = page.content()
            if "403 Forbidden" in body_html:
                log_func("403 Forbiddenç”»é¢ã‚’æ¤œçŸ¥ã€‚2åˆ†é–“å¾…æ©Ÿã—ã¦ãƒªãƒˆãƒ©ã‚¤ã—ã¾ã™ã€‚")
                time.sleep(120)
            else:
                return True
        log_func("403 ForbiddenãŒè§£æ¶ˆã—ã¾ã›ã‚“ã§ã—ãŸã€‚")
        return False
    
    @staticmethod
    def wait_for_page_load(page, log_func, timeout=2):
        """ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿å®Œäº†ã‚’å¾…æ©Ÿ"""
        schedule_links_locator = page.locator('a.dashboard-session_container[href*="/show_attendance?sessiondetailid="]')
        no_schedule_text_locator = page.locator("text=è¬›åº§ãŒã‚ã‚Šã¾ã›ã‚“")
        
        for _ in range(timeout):
            if schedule_links_locator.count() > 0 or no_schedule_text_locator.count() > 0:
                return True
            time.sleep(2)
        return False

class ScheduleHelper:
    """æ—¥ç¨‹é–¢é€£ã®å…±é€šå‡¦ç†ã‚’æä¾›ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹"""
    
    @staticmethod
    def parse_custom_schedules(text):
        """å€‹åˆ¥æ—¥ç¨‹ãƒªã‚¹ãƒˆã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ [(date, start, end)] ã®ãƒªã‚¹ãƒˆã«ã™ã‚‹"""
        result = []
        for line in text.strip().splitlines():
            if not line.strip():
                continue
            try:
                date_part, time_part = line.strip().split('\t')
                start_time, end_time = time_part.split('~')
                result.append((date_part.strip(), start_time.strip(), end_time.strip()))
            except Exception:
                continue
        return result
    
    @staticmethod
    def extract_time_from_text(text):
        """ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰é–‹å§‹æ™‚åˆ»ã‚’æŠ½å‡º"""
        time_match = re.search(r'(\d{1,2}):(\d{2})', text)
        if time_match:
            start_hour, start_min = map(int, time_match.groups())
            return f"{start_hour:02d}:{start_min:02d}"
        return None
    
    @staticmethod
    def find_matching_schedule(links, class_names, start_time):
        """æŒ‡å®šã•ã‚ŒãŸæ¡ä»¶ã«ä¸€è‡´ã™ã‚‹æ—¥ç¨‹ã‚’æ¢ã™"""
        for i in range(links.count()):
            try:
                link = links.nth(i)
                link_text = link.inner_text()
                
                # è¬›åº§åã®ä¸€è‡´ã‚’ç¢ºèª
                if not any(class_name in link_text for class_name in class_names):
                    continue
                
                # é–‹å§‹æ™‚åˆ»ã®ä¸€è‡´ã‚’ç¢ºèªï¼ˆstart_timeãŒNoneã®å ´åˆã¯è¬›åº§åã®ã¿ã§ãƒãƒƒãƒãƒ³ã‚°ï¼‰
                if start_time is not None:
                    link_start_time = ScheduleHelper.extract_time_from_text(link_text)
                    if link_start_time != start_time:
                        continue
                
                return link
            except Exception:
                continue
        return None
    
    @staticmethod
    def delete_schedule(page, link, log_func):
        """æ—¥ç¨‹ã®å‰Šé™¤å‡¦ç†ã‚’å®Ÿè¡Œ"""
        try:
            target_text = link.inner_text()
            target_text_clean = target_text.strip().replace('\n', ' ')
            log_func(f"  - å‰Šé™¤å¯¾è±¡: {target_text_clean}")
            
            # å‰Šé™¤å‰ã®è¬›åº§ä¸€è¦§URLã‚’ä¿å­˜
            original_url = page.url
            
            link.click()
            time.sleep(5)

            cancel_button_1 = page.get_by_role("link", name="é–‹å‚¬ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹")
            expect(cancel_button_1).to_be_visible()
            cancel_button_1.click()
            time.sleep(5)

            modal_cancel_button = page.locator("#sa-modal-cancel").get_by_role("button", name="é–‹å‚¬ã‚­ãƒ£ãƒ³ã‚»ãƒ«")
            expect(modal_cancel_button).to_be_visible()

            page.once("dialog", lambda dialog: (time.sleep(5), dialog.accept()))
            modal_cancel_button.click()

            log_func(f"  - æ—¥ç¨‹å‰Šé™¤ãŒå®Œäº†ã—ã¾ã—ãŸï¼")
            time.sleep(3)
            
            # å‰Šé™¤å¾Œã«è¬›åº§ä¸€è¦§ã«æˆ»ã‚‹
            page.goto(original_url, timeout=60000)
            time.sleep(3)
            
            return True
        except Exception as e:
            log_func(f"  - å‰Šé™¤å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
            # ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã‚‚è¬›åº§ä¸€è¦§ã«æˆ»ã‚‹
            try:
                if 'original_url' in locals():
                    page.goto(original_url, timeout=60000)
                    time.sleep(3)
            except:
                pass
            return False
    
    @staticmethod
    def find_and_delete_schedules(page, log_func, class_names, start_time=None, max_pages=10):
        """æŒ‡å®šã•ã‚ŒãŸæ¡ä»¶ã«ä¸€è‡´ã™ã‚‹æ—¥ç¨‹ã‚’æ¢ã—ã¦å‰Šé™¤ã™ã‚‹ï¼ˆãƒšãƒ¼ã‚¸ãƒ³ã‚°å¯¾å¿œï¼‰"""
        found_any = False
        page_count = 0
        
        while page_count < max_pages:
            page_count += 1
            log_func(f"ãƒšãƒ¼ã‚¸ {page_count} ã‚’ç¢ºèªä¸­...")
            
            # ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã‚’å¾…æ©Ÿ
            if not PlaywrightHelper.wait_for_page_load(page, log_func):
                # æ—¥ç¨‹ãŒãªã„ãƒšãƒ¼ã‚¸ã®å ´åˆã¯æ­£å¸¸çµ‚äº†ã¨ã—ã¦æ‰±ã†
                no_schedule_text = page.locator("text=è¬›åº§ãŒã‚ã‚Šã¾ã›ã‚“")
                if no_schedule_text.count() > 0:
                    log_func("ã“ã®ãƒšãƒ¼ã‚¸ã«æ—¥ç¨‹ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚")
                    break
                else:
                    log_func("ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚")
                    break
            
            # ã“ã®ãƒšãƒ¼ã‚¸ã§å‰Šé™¤å¯¾è±¡ãŒãªããªã‚‹ã¾ã§ç¹°ã‚Šè¿”ã—å‰Šé™¤
            while True:
                # æ—¥ç¨‹ãƒªãƒ³ã‚¯ã‚’å–å¾—
                all_schedule_links = page.locator('a.dashboard-session_container[href*="/show_attendance?sessiondetailid="]')
                
                if all_schedule_links.count() == 0:
                    log_func("ã“ã®ãƒšãƒ¼ã‚¸ã«æ—¥ç¨‹ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚")
                    break
                
                # å‰Šé™¤å¯¾è±¡ã®æ—¥ç¨‹ã‚’æ¢ã™
                target_link = ScheduleHelper.find_matching_schedule(all_schedule_links, class_names, start_time)
                
                if target_link is not None:
                    # å‰Šé™¤å‡¦ç†ã‚’å®Ÿè¡Œ
                    if ScheduleHelper.delete_schedule(page, target_link, log_func):
                        found_any = True
                        continue
                    else:
                        break
                else:
                    # å‰Šé™¤å¯¾è±¡ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã“ã®ãƒšãƒ¼ã‚¸ã®å‡¦ç†ã‚’çµ‚äº†
                    break
            
            # æ¬¡ãƒšãƒ¼ã‚¸ãŒã‚ã‚‹ã‹ç¢ºèª
            next_button = page.locator('a[rel="next"]')
            if next_button.count() > 0:
                href = next_button.first.get_attribute('href')
                if href:
                    next_url = BASE_URL + href
                    page.goto(next_url, timeout=60000)
                    if not PlaywrightHelper.handle_403_forbidden(page, log_func):
                        break
                    continue
            
            # æ¬¡ãƒšãƒ¼ã‚¸ãŒãªã„å ´åˆã¯çµ‚äº†
            break
        
        return found_any

class URLHelper:
    """URLé–¢é€£ã®å…±é€šå‡¦ç†ã‚’æä¾›ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹"""
    
    @staticmethod
    def build_schedule_url(date_param, is_organizer=True):
        """æ—¥ç¨‹ä¸€è¦§ã®URLã‚’æ§‹ç¯‰"""
        base_url = ORGANIZER_SCHEDULE_URL if is_organizer else TEACHER_SCHEDULE_URL
        return f"{base_url}?date={date_param}"
    
    @staticmethod
    def format_date_param(target_date):
        """æ—¥ä»˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ"""
        return target_date.strftime('%Y-%-m-%-d')

def do_login(page_instance: ft.Page, status_text: ft.Text):
    """ èªè¨¼æƒ…å ±ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹å‡¦ç† """
    def update_status(value, color):
        status_text.value = value
        status_text.color = color
        page_instance.update()

    try:
        with sync_playwright() as p:
            browser = p.chromium.launch(headless=False)
            context = browser.new_context()
            page = context.new_page()
            
            page.goto("https://www.street-academy.com/d/users/sign_in")
            update_status("ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„...", "black")
            
            # ãƒ­ã‚°ã‚¤ãƒ³å¾Œã®ç”»é¢ã‚’å¾…æ©Ÿï¼ˆå€‹äººç”¨ã¨ä¸»å‚¬å›£ä½“ç”¨ã®ä¸¡æ–¹ã«å¯¾å¿œï¼‰
            try:
                # å€‹äººç”¨ã¨ä¸»å‚¬å›£ä½“ç”¨ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã©ã¡ã‚‰ã‹ã‚’å¾…æ©Ÿ
                page.wait_for_url(
                    lambda url: url.startswith("https://www.street-academy.com/dashboard/steachers") or 
                               url.startswith("https://www.street-academy.com/dashboard/organizers"),
                    timeout=300000
                )
                
                # å®Ÿéš›ã«é·ç§»ã—ãŸURLã‚’ç¢ºèªã—ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
                current_url = page.url
                if current_url.startswith("https://www.street-academy.com/dashboard/steachers"):
                    update_status("å€‹äººç”¨ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸ", "blue")
                elif current_url.startswith("https://www.street-academy.com/dashboard/organizers"):
                    update_status("ä¸»å‚¬å›£ä½“ç”¨ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸ", "blue")
                else:
                    update_status(f"ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸ: {current_url}", "blue")
                    
            except Exception as e:
                # ãã®ä»–ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ã‚‚ç¢ºèª
                current_url = page.url
                if current_url.startswith("https://www.street-academy.com/dashboard/"):
                    update_status(f"ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸ: {current_url}", "blue")
                else:
                    raise Exception(f"ãƒ­ã‚°ã‚¤ãƒ³å¾Œã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ã«é·ç§»ã—ã¾ã›ã‚“ã§ã—ãŸ: {e}")
            
            context.storage_state(path=AUTH_FILE_PATH)
            browser.close()
        
        update_status("èªè¨¼æˆåŠŸï¼ 'playwright_auth.json' ã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚", "green")
    except Exception as e:
        update_status(f"ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã¾ãŸã¯ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ: {e}", "red")

def run_playwright_task(page_instance: ft.Page, log_text: ft.Text, task_func, *args):
    """Playwrightã‚¿ã‚¹ã‚¯ã‚’åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œã™ã‚‹ãŸã‚ã®å…±é€šãƒ©ãƒƒãƒ‘ãƒ¼"""
    def log(message):
        log_text.value += message + "\n"
        page_instance.update()

    log_text.value = ""
    page_instance.update()

    try:
        task_func(log, *args)
    except Exception as e:
        log(f"äºˆæœŸã›ã¬ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
        print(f"ã‚¨ãƒ©ãƒ¼è©³ç´°: {e}")

def add_schedules_logic(log, urls, contact, schedules_text):
    """å€‹åˆ¥æ—¥ç¨‹ã§æ—¥ç¨‹ã‚’è¿½åŠ ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯"""
    log("å€‹åˆ¥æ—¥ç¨‹ã«ã‚ˆã‚‹æ—¥ç¨‹è¿½åŠ ã‚’é–‹å§‹ã—ã¾ã™...")
    schedules = ScheduleHelper.parse_custom_schedules(schedules_text)
    if not schedules:
        log("æœ‰åŠ¹ãªæ—¥ç¨‹ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\nä¾‹: 2025-08-27\t14:00~15:30")
        return
    
    # URLã‚’æ”¹è¡ŒåŒºåˆ‡ã‚Šã§åˆ†å‰²
    url_list = [url.strip() for url in urls.strip().split('\n') if url.strip()]
    if not url_list:
        log("ã‚¨ãƒ©ãƒ¼: æœ‰åŠ¹ãªURLãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚")
        return
    
    log(f"å‡¦ç†å¯¾è±¡ã®URLæ•°: {len(url_list)}")
    
    try:
        playwright, browser, context = PlaywrightHelper.create_browser_context()
        page = context.new_page()
        
        for url_index, url in enumerate(url_list, 1):
            log(f"\n=== URL {url_index}/{len(url_list)}: {url} ===")
            for schedule_index, (date_str, start_str, end_str) in enumerate(schedules, 1):
                log(f"\n--- æ—¥ç¨‹ {schedule_index}/{len(schedules)}: {date_str} {start_str}~{end_str} ã‚’è¿½åŠ ã—ã¾ã™ ---")
                page.goto(url)
                expect(page.get_by_role("button", name="æ—¥ç¨‹ã‚’è¤‡è£½ã™ã‚‹")).to_be_visible(timeout=30000)

                # ã‚ªãƒ³ãƒ©ã‚¤ãƒ³é¸æŠè‚¢ãŒã‚ã‚Œã°é¸æŠ
                online_radio_button = page.locator("#is_online_check")
                if online_radio_button.is_visible():
                    log("é–‹å‚¬å½¢å¼ã®é¸æŠè‚¢ã‚’æ¤œå‡ºã€‚ã€Œã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã€ã‚’é¸æŠã—ã¾ã™ã€‚")
                    online_radio_button.check()
                    expect(online_radio_button).to_be_checked()
                    log("ã€Œã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã€ã‚’é¸æŠã—ã¾ã—ãŸã€‚")

                first_block = page.locator('div[data-repeater-item]').first
                y, m, d = map(int, date_str.split('-'))
                first_block.locator('select[name*="[session_startdate_year]"]').select_option(str(y))
                first_block.locator('select[name*="[session_startdate_month]"]').select_option(str(m))
                first_block.locator('select[name*="[session_startdate_day]"]').select_option(str(d))
                start_hour, start_min = map(int, start_str.split(':'))
                end_hour, end_min = map(int, end_str.split(':'))
                first_block.locator('select.js_start_time_hour').select_option(str(start_hour))
                first_block.locator('select.js_start_time_minute').select_option(str(start_min))
                first_block.locator('select.js_end_time_hour').select_option(str(end_hour))
                first_block.locator('select.js_end_time_minute').select_option(str(end_min))
                log(f"{start_hour:02d}:{start_min:02d} - {end_hour:02d}:{end_min:02d} ã®æ—¥ç¨‹ã‚’è¨­å®šã—ã¾ã—ãŸã€‚")

                page.locator("#session_detail_multi_form_emergency_contact").fill(contact)
                time.sleep(1)
                page.get_by_role("button", name="ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã§ç¢ºèª").click()
                confirm_button = page.get_by_role("button", name="ç¢ºå®š")
                expect(confirm_button).to_be_visible(timeout=15000)
                time.sleep(1)
                confirm_button.click()
                log("å®Œäº†ãƒšãƒ¼ã‚¸ã¸ã®é·ç§»ã‚’å¾…ã£ã¦ã„ã¾ã™...")
                button1 = page.get_by_role("link", name="é›†å®¢ã™ã‚‹")
                button2 = page.get_by_role("link", name="æ—¥ç¨‹è¿½åŠ ")
                expect(button1.or_(button2).first).to_be_visible(timeout=20000)
                log(f"--- æ—¥ç¨‹ {schedule_index}/{len(schedules)}: {date_str} {start_str}~{end_str} ã®æ—¥ç¨‹è¿½åŠ ãŒå®Œäº†ã—ã¾ã—ãŸï¼ ---")
                time.sleep(3)
    except Exception as e:
        log(f"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
    finally:
        if 'browser' in locals():
            browser.close()
        log("\nã™ã¹ã¦ã®å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸã€‚")

def add_continuous_schedules_logic(log, urls, contact, start_str, end_str):
    """ é€£ç¶šæ—¥ç¨‹è¿½åŠ ã®ãƒ­ã‚¸ãƒƒã‚¯ """
    log("é€£ç¶šæ—¥ç¨‹è¿½åŠ å‡¦ç†ã‚’é–‹å§‹ã—ã¾ã™...")
    start_date = date.fromisoformat(start_str)
    end_date = date.fromisoformat(end_str)
    
    # URLã‚’æ”¹è¡ŒåŒºåˆ‡ã‚Šã§åˆ†å‰²
    url_list = [url.strip() for url in urls.strip().split('\n') if url.strip()]
    if not url_list:
        log("ã‚¨ãƒ©ãƒ¼: æœ‰åŠ¹ãªURLãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚")
        return
    
    log(f"å‡¦ç†å¯¾è±¡ã®URLæ•°: {len(url_list)}")
    
    try:
        playwright, browser, context = PlaywrightHelper.create_browser_context()
        page = context.new_page()

        for url_index, url in enumerate(url_list, 1):
            log(f"\n=== URL {url_index}/{len(url_list)}: {url} ===")
            for single_date in daterange(start_date, end_date):
                log(f"\n--- {single_date.strftime('%Y-%m-%d')} ã®æ—¥ç¨‹ã‚’è¿½åŠ ã—ã¾ã™ ---")
                page.goto(url)
                expect(page.get_by_role("button", name="æ—¥ç¨‹ã‚’è¤‡è£½ã™ã‚‹")).to_be_visible(timeout=30000)

                # ã€Œã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã€ã®ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã‚’é¸æŠ
                online_radio_button = page.locator("#is_online_check")
                if online_radio_button.is_visible():
                    log("é–‹å‚¬å½¢å¼ã®é¸æŠè‚¢ã‚’æ¤œå‡ºã€‚ã€Œã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã€ã‚’é¸æŠã—ã¾ã™ã€‚")
                    online_radio_button.check()
                    expect(online_radio_button).to_be_checked()
                    log("ã€Œã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã€ã‚’é¸æŠã—ã¾ã—ãŸã€‚")
                
                first_block = page.locator('div[data-repeater-item]').first
                first_block.locator('select[name*="[session_startdate_year]"]').select_option(str(single_date.year))
                first_block.locator('select[name*="[session_startdate_month]"]').select_option(str(single_date.month))
                first_block.locator('select[name*="[session_startdate_day]"]').select_option(str(single_date.day))
                first_block.locator('select.js_start_time_hour').select_option(str(HOURS_TO_ADD[0]))
                first_block.locator('select.js_end_time_hour').select_option(str(HOURS_TO_ADD[0] + 1))
                log(f"{HOURS_TO_ADD[0]}:00 - {HOURS_TO_ADD[0]+1}:00 ã®æ—¥ç¨‹ã‚’è¨­å®šã—ã¾ã—ãŸã€‚")

                for hour in HOURS_TO_ADD[1:]:
                    page.get_by_role("button", name="æ—¥ç¨‹ã‚’è¤‡è£½ã™ã‚‹").click()
                    last_block = page.locator('div[data-repeater-item]').last
                    expect(last_block).to_be_visible()
                    end_hour = hour + 1 if hour < 23 else 23
                    last_block.locator('select.js_start_time_hour').select_option(str(hour))
                    last_block.locator('select.js_end_time_hour').select_option(str(end_hour))
                    log(f"{hour}:00 - {end_hour}:00 ã®æ—¥ç¨‹ã‚’è¨­å®šã—ã¾ã—ãŸã€‚")

                page.locator("#session_detail_multi_form_emergency_contact").fill(contact)
                page.get_by_role("button", name="ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã§ç¢ºèª").click()
                confirm_button = page.get_by_role("button", name="ç¢ºå®š")
                expect(confirm_button).to_be_visible(timeout=15000)
                confirm_button.click()
                
                log("å®Œäº†ãƒšãƒ¼ã‚¸ã¸ã®é·ç§»ã‚’å¾…ã£ã¦ã„ã¾ã™...")
                button1 = page.get_by_role("link", name="é›†å®¢ã™ã‚‹")
                button2 = page.get_by_role("link", name="æ—¥ç¨‹è¿½åŠ ")
                expect(button1.or_(button2).first).to_be_visible(timeout=20000)
                
                log(f"--- {single_date.strftime('%Y-%m-%d')} ã®æ—¥ç¨‹è¿½åŠ ãŒå®Œäº†ã—ã¾ã—ãŸï¼ ---")
                time.sleep(3)
    except Exception as e:
        log(f"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
    finally:
        if 'browser' in locals():
            browser.close()
        log("\nã™ã¹ã¦ã®å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸã€‚")

def delete_schedules_logic(log, start_str, end_str, class_names_str):
    """ é€£ç¶šæ—¥ç¨‹å‰Šé™¤ã®ãƒ­ã‚¸ãƒƒã‚¯ """
    log("é€£ç¶šæ—¥ç¨‹å‰Šé™¤å‡¦ç†ã‚’é–‹å§‹ã—ã¾ã™...")
    target_class_names = [name.strip() for name in class_names_str.strip().split('\n') if name.strip()]
    if not target_class_names:
        log("ã‚¨ãƒ©ãƒ¼: å‰Šé™¤å¯¾è±¡ã®è¬›åº§åãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚")
        return

    log(f"å‰Šé™¤å¯¾è±¡ã®è¬›åº§å: {', '.join(target_class_names)}")
    start_date = date.fromisoformat(start_str)
    end_date = date.fromisoformat(end_str)

    try:
        playwright, browser, context = PlaywrightHelper.create_browser_context()
        page = context.new_page()

        for single_date in daterange(start_date, end_date):
            log(f"\n--- {single_date.strftime('%Y-%m-%d')} ã®æ—¥ç¨‹å‰Šé™¤ã‚’é–‹å§‹ã—ã¾ã™ ---")
            date_param = URLHelper.format_date_param(single_date)
            base_url = URLHelper.build_schedule_url(date_param)

            # å…±é€šåŒ–ã•ã‚ŒãŸãƒšãƒ¼ã‚¸ãƒ³ã‚°å‡¦ç†ã‚’ä½¿ç”¨
            log(f"ã‚¢ã‚¯ã‚»ã‚¹ä¸­: {base_url}")
            page.goto(base_url, timeout=60000)
            if not PlaywrightHelper.handle_403_forbidden(page, log):
                continue

            found_any = ScheduleHelper.find_and_delete_schedules(page, log, target_class_names, None)
            
            if not found_any:
                log("ã“ã®æ—¥ä»˜ã«å‰Šé™¤å¯¾è±¡ã®è¬›åº§ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚")
    except Exception as e:
        log(f"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
    finally:
        if 'browser' in locals():
            browser.close()
        log("\nã™ã¹ã¦ã®å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸã€‚")

def delete_custom_schedules_logic(log, schedules_text, class_names_str):
    """å€‹åˆ¥æ—¥ç¨‹ã§æ—¥ç¨‹ã‚’å‰Šé™¤ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯"""
    log("å€‹åˆ¥æ—¥ç¨‹ã«ã‚ˆã‚‹æ—¥ç¨‹å‰Šé™¤ã‚’é–‹å§‹ã—ã¾ã™...")
    schedules = ScheduleHelper.parse_custom_schedules(schedules_text)
    if not schedules:
        log("æœ‰åŠ¹ãªæ—¥ç¨‹ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\nä¾‹: 2025-08-27\t14:00~15:30")
        return
    
    target_class_names = [name.strip() for name in class_names_str.strip().split('\n') if name.strip()]
    if not target_class_names:
        log("ã‚¨ãƒ©ãƒ¼: å‰Šé™¤å¯¾è±¡ã®è¬›åº§åãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚")
        return
    
    log(f"å‰Šé™¤å¯¾è±¡ã®è¬›åº§å: {', '.join(target_class_names)}")

    try:
        playwright, browser, context = PlaywrightHelper.create_browser_context()
        page = context.new_page()

        for schedule_index, (date_str, start_str, end_str) in enumerate(schedules, 1):
            log(f"\n--- æ—¥ç¨‹ {schedule_index}/{len(schedules)}: {date_str} {start_str}~{end_str} ã‚’å‰Šé™¤ã—ã¾ã™ ---")
            
            # æ—¥ä»˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½œæˆ
            target_date = date.fromisoformat(date_str)
            date_param = URLHelper.format_date_param(target_date)
            base_url = URLHelper.build_schedule_url(date_param)
            
            found_schedule = False
            
            # å…±é€šåŒ–ã•ã‚ŒãŸãƒšãƒ¼ã‚¸ãƒ³ã‚°å‡¦ç†ã‚’ä½¿ç”¨
            log(f"ã‚¢ã‚¯ã‚»ã‚¹ä¸­: {base_url}")
            page.goto(base_url, timeout=60000)
            if not PlaywrightHelper.handle_403_forbidden(page, log):
                continue

            found_schedule = ScheduleHelper.find_and_delete_schedules(page, log, target_class_names, start_str)
            
            if not found_schedule:
                log(f"è¬›åº§åã¨é–‹å§‹æ™‚åˆ» {start_str} ã«ä¸€è‡´ã™ã‚‹æ—¥ç¨‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚")

            # æ—¥ç¨‹ãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã®ãƒ­ã‚°
            if not found_schedule:
                log(f"æ—¥ç¨‹ {schedule_index}/{len(schedules)}: {date_str} {start_str}~{end_str} ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚")
    except Exception as e:
        log(f"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
    finally:
        if 'browser' in locals():
            browser.close()
        log("\nã™ã¹ã¦ã®å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸã€‚")

def daterange(start_date, end_date):
    for n in range(int((end_date - start_date).days) + 1):
        yield start_date + timedelta(n)

def main(page: ft.Page):
    page.title = "ã‚¹ãƒˆã‚¢ã‚«æ—¥ç¨‹è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«"
    page.vertical_alignment = ft.MainAxisAlignment.START
    page.window_width = 700
    page.window_height = 800

    def check_auth_status():
        if os.path.exists(AUTH_FILE_PATH):
            return "èªè¨¼æ¸ˆã¿", "green"
        else:
            return "æœªèªè¨¼ (æœ€åˆã«ãƒ­ã‚°ã‚¤ãƒ³ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„)", "red"

    def run_in_thread(target_func, *args):
        thread = threading.Thread(target=target_func, args=args, daemon=True)
        thread.start()

    initial_text, initial_color = check_auth_status()
    auth_status_text = ft.Text(value=initial_text, color=initial_color)
    
    def handle_login(e):
        thread = threading.Thread(target=do_login, args=(page, auth_status_text), daemon=True)
        thread.start()
    
    login_button = ft.ElevatedButton("ãƒ­ã‚°ã‚¤ãƒ³ / èªè¨¼æƒ…å ±ã‚’ä½œæˆ (åˆå›ã®ã¿)", on_click=handle_login)


    # --- æ—¥ç¨‹è¿½åŠ æ–¹å¼ã®é¸æŠãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ ---
    add_mode = ft.RadioGroup(
        content=ft.Row([
            ft.Radio(value="custom", label="å€‹åˆ¥æ—¥ç¨‹è¿½åŠ "),
            ft.Radio(value="normal", label="é€£ç¶šæ—¥ç¨‹è¿½åŠ ")
        ]),
        value="custom"
    )

    # --- é€£ç¶šæ—¥ç¨‹è¿½åŠ ç”¨UI ---
    url_input = ft.TextField(
        label="æ—¥ç¨‹è¿½åŠ ãƒšãƒ¼ã‚¸ã®URL (è¤‡æ•°ã®å ´åˆã¯æ”¹è¡Œã—ã¦å…¥åŠ›)", 
        width=600,
        multiline=True,
        min_lines=3,
        hint_text="ä¾‹:\nhttps://www.street-academy.com/session_details/new_multi_session?classdetailid=123456\nhttps://www.street-academy.com/session_details/new_multi_session?classdetailid=789012",
        hint_style=ft.TextStyle(color="#bbbbbb")
    )
    contact_input = ft.TextField(label="ç·Šæ€¥é€£çµ¡å…ˆ", value=EMERGENCY_CONTACT, width=300)
    add_start_date = ft.TextField(label="é–‹å§‹æ—¥ (YYYY-MM-DD)", width=200)
    add_end_date = ft.TextField(label="çµ‚äº†æ—¥ (YYYY-MM-DD)", width=200)
    add_button = ft.ElevatedButton("é€£ç¶šæ—¥ç¨‹è¿½åŠ ", bgcolor="blue", color="white")

    # --- å€‹åˆ¥æ—¥ç¨‹è¿½åŠ ç”¨UI ---
    custom_schedules_input = ft.TextField(
        label="å€‹åˆ¥æ—¥ç¨‹ãƒªã‚¹ãƒˆ (ä¾‹: 2025-08-27\t14:00~15:30)",
        multiline=True,
        min_lines=3,
        width=600,
        hint_text="ä¾‹:\n2025-08-27\t14:00~15:30\n2025-08-28\t12:00~14:00",
        hint_style=ft.TextStyle(color="#bbbbbb")
    )
    add_custom_button = ft.ElevatedButton("å€‹åˆ¥æ—¥ç¨‹è¿½åŠ ", bgcolor="green", color="white")

    # æ’ä»–åˆ¶å¾¡ç”¨ãƒ•ãƒ©ã‚°
    add_running = {'value': False}

    def set_add_running(state: bool):
        add_running['value'] = state
        add_button.disabled = state
        add_custom_button.disabled = state
        page.update()

    def handle_add_schedules(e):
        if add_running['value']:
            return
        set_add_running(True)
        def wrapped():
            try:
                run_playwright_task(page, log_view, add_continuous_schedules_logic, url_input.value, contact_input.value, add_start_date.value, add_end_date.value)
            finally:
                set_add_running(False)
        run_in_thread(wrapped)
    add_button.on_click = handle_add_schedules

    def handle_add_custom_schedules(e):
        if add_running['value']:
            return
        set_add_running(True)
        def wrapped():
            try:
                run_playwright_task(page, log_view, add_schedules_logic, url_input.value, contact_input.value, custom_schedules_input.value)
            finally:
                set_add_running(False)
        run_in_thread(wrapped)
    add_custom_button.on_click = handle_add_custom_schedules

    # --- æ—¥ç¨‹è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ ã®åˆ‡ã‚Šæ›¿ãˆ ---
    normal_add_form = ft.Column([
        url_input,
        contact_input,
        ft.Row([add_start_date, add_end_date]),
        add_button
    ])
    custom_add_form = ft.Column([
        url_input,
        contact_input,
        custom_schedules_input,
        add_custom_button
    ])

    add_form_container = ft.Container()

    def update_add_form(_=None):
        if add_mode.value == "normal":
            add_form_container.content = normal_add_form
        else:
            add_form_container.content = custom_add_form
        page.update()

    add_mode.on_change = update_add_form
    update_add_form()

    # --- æ—¥ç¨‹å‰Šé™¤æ–¹å¼ã®é¸æŠãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ ---
    delete_mode = ft.RadioGroup(
        content=ft.Row([
            ft.Radio(value="custom", label="å€‹åˆ¥æ—¥ç¨‹å‰Šé™¤"),
            ft.Radio(value="normal", label="é€£ç¶šæ—¥ç¨‹å‰Šé™¤")
        ]),
        value="custom"
    )

    # --- é€£ç¶šæ—¥ç¨‹å‰Šé™¤ç”¨UI ---
    delete_start_date = ft.TextField(label="é–‹å§‹æ—¥ (YYYY-MM-DD)", width=200)
    delete_end_date = ft.TextField(label="çµ‚äº†æ—¥ (YYYY-MM-DD)", width=200)
    class_names_input = ft.TextField(
        label="å‰Šé™¤å¯¾è±¡ã®è¬›åº§å (è¤‡æ•°ã‚ã‚‹å ´åˆã¯æ”¹è¡Œã—ã¦å…¥åŠ›)",
        multiline=True,
        min_lines=3,
        width=600,
        hint_text="ä¾‹:\nNotebookLMã«è³‡æ–™æŠ•å…¥ï¼\nAIã¨GASã§å¤¢ã®æ™‚çŸ­è¡“ï¼",
        hint_style=ft.TextStyle(color="#bbbbbb")
    )
    delete_by_name_button = ft.ElevatedButton("é€£ç¶šæ—¥ç¨‹å‰Šé™¤", bgcolor="red", color="white")

    # --- å€‹åˆ¥æ—¥ç¨‹å‰Šé™¤ç”¨UI ---
    delete_custom_schedules_input = ft.TextField(
        label="å‰Šé™¤å¯¾è±¡ã®æ—¥ç¨‹ãƒªã‚¹ãƒˆ (ä¾‹: 2025-08-27\t14:00~15:30)",
        multiline=True,
        min_lines=3,
        width=600,
        hint_text="ä¾‹:\n2025-08-27\t14:00~15:30\n2025-08-28\t12:00~14:00",
        hint_style=ft.TextStyle(color="#bbbbbb")
    )
    delete_custom_button = ft.ElevatedButton("å€‹åˆ¥æ—¥ç¨‹å‰Šé™¤", bgcolor="orange", color="white")

    # æ’ä»–åˆ¶å¾¡ç”¨ãƒ•ãƒ©ã‚°
    delete_running = {'value': False}

    def set_delete_running(state: bool):
        delete_running['value'] = state
        delete_by_name_button.disabled = state
        delete_custom_button.disabled = state
        page.update()

    def handle_delete_schedules(e):
        if delete_running['value']:
            return
        set_delete_running(True)
        def wrapped():
            try:
                run_playwright_task(page, log_view, delete_schedules_logic, delete_start_date.value, delete_end_date.value, class_names_input.value)
            finally:
                set_delete_running(False)
        run_in_thread(wrapped)
    delete_by_name_button.on_click = handle_delete_schedules

    def handle_delete_custom_schedules(e):
        if delete_running['value']:
            return
        set_delete_running(True)
        def wrapped():
            try:
                run_playwright_task(page, log_view, delete_custom_schedules_logic, delete_custom_schedules_input.value, class_names_input.value)
            finally:
                set_delete_running(False)
        run_in_thread(wrapped)
    delete_custom_button.on_click = handle_delete_custom_schedules

    # --- æ—¥ç¨‹å‰Šé™¤ãƒ•ã‚©ãƒ¼ãƒ ã®åˆ‡ã‚Šæ›¿ãˆ ---
    normal_delete_form = ft.Column([
        class_names_input,
        ft.Row([delete_start_date, delete_end_date]),
        delete_by_name_button
    ])
    custom_delete_form = ft.Column([
        class_names_input,
        delete_custom_schedules_input,
        delete_custom_button
    ])

    delete_form_container = ft.Container()

    def update_delete_form(_=None):
        if delete_mode.value == "normal":
            delete_form_container.content = normal_delete_form
        else:
            delete_form_container.content = custom_delete_form
        page.update()

    delete_mode.on_change = update_delete_form
    update_delete_form()

    # ãƒ­ã‚°è¡¨ç¤ºç”¨UI
    log_view = ft.Text("", selectable=True, font_family="monospace", size=12)
    log_container = ft.Container(
        content=ft.Column([log_view], scroll=ft.ScrollMode.ADAPTIVE, expand=True),
        border=ft.border.all(1, "grey"),
        padding=10,
        expand=True,
    )
    
    page.add(
        ft.Column([
            ft.Row([login_button, auth_status_text], alignment=ft.MainAxisAlignment.START),
            ft.Divider(),
            ft.Text("æ—¥ç¨‹ã®è¿½åŠ ", size=20, weight=ft.FontWeight.BOLD),
            add_mode,
            add_form_container,
            ft.Divider(),
            ft.Text("æ—¥ç¨‹ã®å‰Šé™¤", size=20, weight=ft.FontWeight.BOLD),
            delete_mode,
            delete_form_container,
            ft.Divider(),
            ft.Text("å®Ÿè¡Œãƒ­ã‚°", size=16),
            log_container
        ], expand=True, scroll=ft.ScrollMode.ADAPTIVE)
    )

if __name__ == "__main__":
    ft.app(target=main)
```

ã€é‡è¦ã€‘ ä½œæˆã—ãŸ`app.py`ã‚’é–‹ãã€å…ˆé ­éƒ¨åˆ†ã®**è¨­å®šé …ç›®ï¼ˆ`EMERGENCY_CONTACT`ï¼‰**ã‚’è‡ªåˆ†ã®æƒ…å ±ã«å¿…ãšæ›¸ãæ›ãˆã¦ãã ã•ã„ã€‚

---

### ã‚¹ãƒ†ãƒƒãƒ—3ï¼šã€åˆå›ã®ã¿ã€‘èªè¨¼æƒ…å ±ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹

1.  **ä»®æƒ³ç’°å¢ƒã‚’æœ‰åŠ¹åŒ–**ã—ã¾ã™ã€‚ï¼ˆã€Œ1-4. ä»®æƒ³ç’°å¢ƒã®ä½œæˆã¨æœ‰åŠ¹åŒ– (Mac / Windowså…±é€š)ã€ã®â‘¡ï¼‰
2.  `python app.py` ã‚’å®Ÿè¡Œã—ã¦ãƒ„ãƒ¼ãƒ«ã‚’èµ·å‹•ã—ã¾ã™ã€‚
3.  ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€ä¸€ç•ªä¸Šã«ã‚ã‚‹ã€ãƒ­ã‚°ã‚¤ãƒ³ / èªè¨¼æƒ…å ±ã‚’ä½œæˆ (åˆå›ã®ã¿)ã€‘ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
4.  ãƒ–ãƒ©ã‚¦ã‚¶ãŒèµ·å‹•ã™ã‚‹ã®ã§ã€**æ‰‹å‹•ã§ã‚¹ãƒˆã‚¢ã‚«ã«ãƒ­ã‚°ã‚¤ãƒ³**ã—ã¦ãã ã•ã„ã€‚
5.  ãƒ­ã‚°ã‚¤ãƒ³ãŒå®Œäº†ã™ã‚‹ã¨ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯è‡ªå‹•ã§é–‰ã˜ã€ãƒ„ãƒ¼ãƒ«ç”»é¢ã®ã€Œæœªèªè¨¼ã€ã¨ã„ã†è¡¨ç¤ºãŒã€èªè¨¼æ¸ˆã¿ã€‘ã«å¤‰ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã§èªè¨¼ã¯å®Œäº†ã§ã™ã€‚

---

### ã‚¹ãƒ†ãƒƒãƒ—4ï¼šã€å®Ÿè¡Œã€‘è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã‚’å‹•ã‹ã™

1.  `python app.py` ã§ãƒ„ãƒ¼ãƒ«ã‚’èµ·å‹•ã—ã¾ã™ï¼ˆä»®æƒ³ç’°å¢ƒã®æœ‰åŠ¹åŒ–ã‚’å¿˜ã‚Œãšã«ï¼‰ã€‚
2.  **æ—¥ç¨‹ã‚’è¿½åŠ ã™ã‚‹å ´åˆ**:
    *   ã€æ—¥ç¨‹è¿½åŠ ãƒšãƒ¼ã‚¸ã®URLã€‘ã¨ã€ç·Šæ€¥é€£çµ¡å…ˆã€‘ãŒæ­£ã—ã„ã‹ç¢ºèªãƒ»ä¿®æ­£ã—ã¾ã™ã€‚
    *   **å€‹åˆ¥æ—¥ç¨‹è¿½åŠ **ã®å ´åˆ:
        - ã€Œå€‹åˆ¥æ—¥ç¨‹è¿½åŠ ã€ã‚’é¸æŠ
        - æ—¥ç¨‹ãƒªã‚¹ãƒˆã«æ—¥æ™‚ã‚’å…¥åŠ›ï¼ˆä¾‹: `2025-08-27	14:00~15:30`ï¼‰
        - ã€å€‹åˆ¥æ—¥ç¨‹è¿½åŠ ã€‘ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    *   **é€£ç¶šæ—¥ç¨‹è¿½åŠ **ã®å ´åˆ:
        - ã€Œé€£ç¶šæ—¥ç¨‹è¿½åŠ ã€ã‚’é¸æŠ
        - è¿½åŠ ã—ãŸã„ã€é–‹å§‹æ—¥ã€‘ã¨ã€çµ‚äº†æ—¥ã€‘ã‚’`YYYY-MM-DD`å½¢å¼ã§å…¥åŠ›
        - ã€é€£ç¶šæ—¥ç¨‹è¿½åŠ ã€‘ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆ8:00ã€œ22:00ã®è¬›åº§ãŒè‡ªå‹•ç”Ÿæˆï¼‰
3.  **æ—¥ç¨‹ã‚’å‰Šé™¤ã™ã‚‹å ´åˆ**:
    *   **å€‹åˆ¥æ—¥ç¨‹å‰Šé™¤**ã®å ´åˆ:
        - ã€Œå€‹åˆ¥æ—¥ç¨‹å‰Šé™¤ã€ã‚’é¸æŠ
        - å‰Šé™¤ã—ãŸã„è¬›åº§åã‚’å…¥åŠ›
        - å‰Šé™¤ã—ãŸã„æ—¥ç¨‹ãƒªã‚¹ãƒˆã‚’å…¥åŠ›ï¼ˆä¾‹: `2025-08-27	14:00~15:30`ï¼‰
        - ã€å€‹åˆ¥æ—¥ç¨‹å‰Šé™¤ã€‘ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    *   **é€£ç¶šæ—¥ç¨‹å‰Šé™¤**ã®å ´åˆ:
        - ã€Œé€£ç¶šæ—¥ç¨‹å‰Šé™¤ã€ã‚’é¸æŠ
        - å‰Šé™¤ã—ãŸã„è¬›åº§åã‚’å…¥åŠ›
        - å‰Šé™¤ã—ãŸã„ã€é–‹å§‹æ—¥ã€‘ã¨ã€çµ‚äº†æ—¥ã€‘ã‚’å…¥åŠ›
        - ã€é€£ç¶šæ—¥ç¨‹å‰Šé™¤ã€‘ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆæœŸé–“å†…ã®æŒ‡å®šè¬›åº§ã®å…¨æ—¥ç¨‹ã‚’å‰Šé™¤ï¼‰

å®Ÿè¡Œã™ã‚‹ã¨ã€ãƒ–ãƒ©ã‚¦ã‚¶ãŒè‡ªå‹•ã§ç«‹ã¡ä¸ŠãŒã‚Šã€å‡¦ç†ãŒé–‹å§‹ã•ã‚Œã¾ã™ã€‚ä¸‹éƒ¨ã®ã€Œå®Ÿè¡Œãƒ­ã‚°ã€ã«é€²æ—ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

---

### ï¼ˆè£œè¶³ï¼‰ä»®æƒ³ç’°å¢ƒã‚’çµ‚äº†ã™ã‚‹ã«ã¯

ã™ã¹ã¦ã®ä½œæ¥­ãŒçµ‚ã‚ã£ãŸå¾Œã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®è¡Œé ­ã«ã‚ã‚‹ `(.venv)` ã®è¡¨ç¤ºã‚’æ¶ˆã—ã¦å…ƒã®çŠ¶æ…‹ã«æˆ»ã—ãŸã„å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```sh
deactivate
```

---

## æ—¥å¸¸çš„ãªä½¿ã„æ–¹ï¼ˆ2å›ç›®ä»¥é™ã®ä½œæ¥­ï¼‰

åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ã¦ã„ã‚Œã°ã€æ¬¡å›ã‹ã‚‰ã¯ã“ã®æ‰‹é †ã ã‘ã§ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ãˆã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—1ï¼šãƒ„ãƒ¼ãƒ«ã®èµ·å‹•

1.  **ã‚¿ãƒ¼ãƒŸãƒŠãƒ«**ï¼ˆWindowsã®å ´åˆã¯**ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**ï¼‰ã‚’é–‹ãã¾ã™ã€‚
2.  `cd` ã‚³ãƒãƒ³ãƒ‰ã§ã€å‰å›ä½œæˆã—ãŸ `street_academy_automation` ãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•ã—ã¾ã™ã€‚
    ```sh
    # ä¾‹
    cd ~/Desktop/street_academy_automation
    ```
3.  **ä»®æƒ³ç’°å¢ƒã‚’æœ‰åŠ¹åŒ–**ã—ã¾ã™ã€‚
    *   **Mac ã®å ´åˆ:**
        ```sh
        source .venv/bin/activate
        ```
    *   **Windows ã®å ´åˆ:**
        ```powershell
        .\.venv\Scripts\activate
        ```
4.  ãƒ„ãƒ¼ãƒ«ã‚’èµ·å‹•ã—ã¾ã™ã€‚
    *   **Mac ã®å ´åˆ:** `python app.py`
    *   **Windows ã®å ´åˆ:** `python app.py`

### ã‚¹ãƒ†ãƒƒãƒ—2ï¼šæ—¥ç¨‹ã®è¿½åŠ ã¾ãŸã¯å‰Šé™¤

ãƒ„ãƒ¼ãƒ«ãŒèµ·å‹•ã—ãŸã‚‰ã€ã‚ã¨ã¯ç”»é¢ã®æŒ‡ç¤ºã«å¾“ã£ã¦æ“ä½œã—ã¾ã™ã€‚

*   **æ—¥ç¨‹ã‚’è¿½åŠ ã™ã‚‹å ´åˆ**:
    1.  å¿…è¦ã§ã‚ã‚Œã°ã€æ—¥ç¨‹è¿½åŠ ãƒšãƒ¼ã‚¸ã®URLã€‘ãªã©ã‚’ä¿®æ­£ã—ã¾ã™ã€‚
    2.  **å€‹åˆ¥æ—¥ç¨‹è¿½åŠ **ã®å ´åˆ:
        - ã€Œå€‹åˆ¥æ—¥ç¨‹è¿½åŠ ã€ã‚’é¸æŠ
        - æ—¥ç¨‹ãƒªã‚¹ãƒˆã«æ—¥æ™‚ã‚’å…¥åŠ›ï¼ˆä¾‹: `2025-08-27	14:00~15:30`ï¼‰
        - ã€å€‹åˆ¥æ—¥ç¨‹è¿½åŠ ã€‘ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    3.  **é€£ç¶šæ—¥ç¨‹è¿½åŠ **ã®å ´åˆ:
        - ã€Œé€£ç¶šæ—¥ç¨‹è¿½åŠ ã€ã‚’é¸æŠ
        - è¿½åŠ ã—ãŸã„ã€é–‹å§‹æ—¥ã€‘ã¨ã€çµ‚äº†æ—¥ã€‘ã‚’`YYYY-MM-DD`å½¢å¼ã§å…¥åŠ›
        - ã€é€£ç¶šæ—¥ç¨‹è¿½åŠ ã€‘ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆ8:00ã€œ22:00ã®è¬›åº§ãŒè‡ªå‹•ç”Ÿæˆï¼‰
*   **æ—¥ç¨‹ã‚’å‰Šé™¤ã™ã‚‹å ´åˆ**:
    1.  **å€‹åˆ¥æ—¥ç¨‹å‰Šé™¤**ã®å ´åˆ:
        - ã€Œå€‹åˆ¥æ—¥ç¨‹å‰Šé™¤ã€ã‚’é¸æŠ
        - å‰Šé™¤ã—ãŸã„è¬›åº§åã‚’å…¥åŠ›
        - å‰Šé™¤ã—ãŸã„æ—¥ç¨‹ãƒªã‚¹ãƒˆã‚’å…¥åŠ›ï¼ˆä¾‹: `2025-08-27	14:00~15:30`ï¼‰
        - ã€å€‹åˆ¥æ—¥ç¨‹å‰Šé™¤ã€‘ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    2.  **é€£ç¶šæ—¥ç¨‹å‰Šé™¤**ã®å ´åˆ:
        - ã€Œé€£ç¶šæ—¥ç¨‹å‰Šé™¤ã€ã‚’é¸æŠ
        - å‰Šé™¤ã—ãŸã„è¬›åº§åã‚’å…¥åŠ›
        - å‰Šé™¤ã—ãŸã„ã€é–‹å§‹æ—¥ã€‘ã¨ã€çµ‚äº†æ—¥ã€‘ã‚’å…¥åŠ›
        - ã€é€£ç¶šæ—¥ç¨‹å‰Šé™¤ã€‘ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆæœŸé–“å†…ã®æŒ‡å®šè¬›åº§ã®å…¨æ—¥ç¨‹ã‚’å‰Šé™¤ï¼‰

å®Ÿè¡Œã™ã‚‹ã¨ãƒ–ãƒ©ã‚¦ã‚¶ãŒè‡ªå‹•ã§å‹•ãå‡ºã—ã€å‡¦ç†ãŒçµ‚ã‚ã‚‹ã¨è‡ªå‹•ã§é–‰ã˜ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—3ï¼šãƒ„ãƒ¼ãƒ«ã®çµ‚äº†

1.  ãƒ„ãƒ¼ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‰ã˜ã¾ã™ã€‚
2.  ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ `deactivate` ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€ä»®æƒ³ç’°å¢ƒã‚’çµ‚äº†ã—ã¾ã™ã€‚
    ```sh
    deactivate
    ```
