# ストアカ日程追加・削除 自動化ツール

面倒なストアカの講座日程の「追加」と「削除」を、クリック操作で簡単に行うためのツールです。

## 機能

### 📅 日程の追加
2つの方式で日程を追加できます：

#### 1. 個別日程追加
TSV（タブ区切り）形式で、複数の日程を一度にまとめて登録します。講座ごとに異なる設定（料金、定員など）が可能です。

- **入力形式**: 以下の8つの項目をタブで区切って入力します。1行目にヘッダーがあっても自動で認識・無視されます。
  `講座名	講座ID	日付	時間	定員	受講料	締め切り日時	緊急連絡先`

- **入力例**:
  ```tsv
  講座名	講座ID	日程	時間	定員	受講料	締め切り日時	緊急連絡先
  GASシステム開発入門！	198561	2025-10-01	21:00~22:00	1	1000	1日前	090-1234-5678
  Googleフォーム基礎講座	198560	2025-10-03	21:00~22:00	1	1000	1日前	090-9876-5432
  ```
- **特徴**:
    - 異なる講座や条件の日程を一度にまとめて設定可能です。
    - **講座名チェック機能**: 安全のため、日程追加ページに表示されている講座名と、入力された講座名が一致するかを自動で確認します。一致しない場合は、その日程の追加をスキップし、処理の最後にログで通知します。
- **締め切り日時の形式**: `1日前`, `12時間前`, `30分前` のように、数値と単位（日・時間・分）を組み合わせて指定します。

#### 2. 連続日程追加
指定した期間、毎日同じ時間帯の講座を一括で作成します。

- **入力**:
    - **日程追加ページのURL**: 対象講座のURL（複数指定可）
    - **緊急連絡先**: 共通の連絡先
    - **開始日**と**終了日**: YYYY-MM-DD形式
- **自動生成される時間帯**: 8:00-9:00, 9:00-10:00, ..., 22:00-23:00
  > ※生成される時間帯は `app.py` ファイル内の `HOURS_TO_ADD` 定数で変更可能です。

#### 共通の自動化機能
- **オンライン開催**: 日程追加時、開催形式で「オンライン」が自動的に選択されます。

### 🗑️ 日程の削除
2つの方式で日程を削除できます：

#### 1. 個別日程削除
- **機能**: 日時を個別に指定して日程を削除
- **入力**: 講座名（複数の場合は改行区切り）、日程リスト
- **入力形式**: `日付<スペースまたはタブ>開始時間`
- **例**: 
  ```
  2025-08-27 14:00
  2025-08-28	12:00
  ```
- **特徴**: 自由な日時で日程を削除可能。予約者が1人以上いる場合は自動でスキップされます。

#### 2. 連続日程削除
- **機能**: 指定した期間の対象講座日程を一括削除
- **入力**: 講座名（複数の場合は改行区切り）、開始日、終了日
- **特徴**: 期間内の指定講座の全日程を一括削除

#### 共通機能
- **講座名フィルタリング**: 指定した講座名のみを削除対象とする
- **複数講座対応**: 複数の講座名を改行区切りで指定可能

## 推奨動作環境

本ツールを快適に利用するためには、以下のスペックを満たすPCを推奨します。

| チェックポイント | Mac | Windows | 備考 |
| :--- | :--- | :--- | :--- |
| **OS** | macOS 12.0 (Monterey) 以降 | Windows 10 / 11 (64bit) | 新しいほど安定します |
| **CPU** | Apple Silicon (M1/M2/M3) / Intel Core i5 以上 | Intel Core i5 / AMD Ryzen 5 (第8世代以降) 以上 | 近年のモデルならOK |
| **メモリ(RAM)** | **8GB以上 (16GB推奨)** | **8GB以上 (16GB推奨)** | 最も重要な項目です |
| **ストレージ** | 10GB以上の空き容量 | 10GB以上の空き容量 | インストールに必要 |

基本的に、**5〜6年以内に購入された一般的なノートPCやデスクトップPC**であれば、問題なく動作する可能性が高いです。
ツールの動作が遅いと感じる場合は、メモリ(RAM)が不足している可能性があります。

## 導入手順

### 1. 【事前準備】 必要なツールのインストール

お使いのPCにPythonと関連ツールをインストールします。お使いのOS（MacまたはWindows）に合わせて手順を実行してください。

---
#### <img src="https://www.apple.com/favicon.ico" width="16"> Macユーザー向け手順

##### 1-1. Homebrewのインストール確認と実行
Mac用のパッケージ管理ツール「Homebrew」を準備します。

まず、**ターミナル**を開き、以下のコマンドでHomebrewがインストール済みか確認します。
```sh
command -v brew
```
*   `/opt/homebrew/bin/brew` のようなパスが表示されれば、**インストール済み**です。次の手順に進んでください。
*   何も表示されなければ、**未インストール**です。以下のコマンドを貼り付けて実行し、Homebrewをインストールしてください。
    ```sh
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    ```

##### 1-2. Pythonのインストール確認と実行
次に、Homebrewを使ってPythonをインストールします。

まず、ターミナルでPythonがインストール済みか確認します。
```bash
python3 --version
```
*   `Python 3.x.x` のようにバージョンが表示されれば、**インストール済み**です。次の「1-3. プロジェクトフォルダの準備」に進んでください。
*   `command not found` のようなエラーが出れば、**未インストール**です。以下のコマンドでPythonをインストールしてください。
    ```bash
    brew install python3
    ```
    完了したら、ターミナルを一度完全に終了し、再起動してください。

##### 1-3. プロジェクトフォルダの準備と移動
GitHubからプロジェクトをクローンします。

```sh
# 例: デスクトップにクローン
cd ~/Desktop
git clone https://github.com/your-username/street_academy_automation.git
cd street_academy_automation
```

---
#### <img src="https://www.microsoft.com/favicon.ico" width="16"> Windowsユーザー向け手順

##### 1-1. Pythonのインストール確認と実行
まず、コマンドプロンプトまたはPowerShellでPythonがインストール済みか確認します。
```powershell
python --version
```
*   `Python 3.x.x` のようにバージョンが表示されれば、**インストール済み**です。次の「1-2. プロジェクトフォルダの準備」に進んでください。
*   `python は、内部コマンドまたは外部コマンド...` などのエラーが出れば、**未インストール**です。以下の手順でPythonをインストールしてください。

1.  [Python公式サイトのダウンロードページ](https://www.python.org/downloads/)にアクセスします。
2.  「Download Python 3.x.x」ボタンをクリックしてインストーラーをダウンロードします。
3.  インストーラーを起動し、**必ず「Add Python 3.x to PATH」のチェックボックスにチェックを入れてから**、「Install Now」をクリックします。

    ![Python for Windows Installer](https://docs.python.org/3/_images/win_installer.png)

##### 1-2. プロジェクトフォルダの準備と移動
GitHubからプロジェクトをクローンします。**コマンドプロンプト**または**PowerShell**を開いて実行してください。

```powershell
# 例: デスクトップにクローン
cd ~/Desktop
git clone https://github.com/kwansai724/street_academy_automation.git
cd street_academy_automation
```
---
#### 1-3. 仮想環境の作成と有効化 (Mac / Windows共通)

プロジェクト専用のクリーンな環境を作ります。これ以降のコマンドは、Macは**ターミナル**、Windowsは**コマンドプロンプト**で実行します。

① **仮想環境の作成** (フォルダ内で初回のみ)
```sh
# Mac / Windows 共通
python -m venv .venv
```

② **仮想環境の有効化** (このフォルダで作業する際は毎回実行)
*   **Mac の場合:**
    ```sh
    source .venv/bin/activate
    ```
*   **Windows の場合:**
    ```powershell
    .\.venv\Scripts\activate
    ```
    > **エラーが出る場合:**  
    > `このシステムではスクリプトの実行が無効になっているため...` というエラーが表示された場合は、以下の手順で実行ポリシーを変更してください。この操作はPC全体の設定変更のため、**最初の1回だけ**でOKです。
    > 
    > 1. **スタートメニュー**で「PowerShell」と検索します。
    > 2. 「Windows PowerShell」を**右クリック**し、「**管理者として実行**」を選択します。
    > 3. 管理者権限で開いたPowerShellで、以下のコマンドを実行します。
    >    ```powershell
    >    Set-ExecutionPolicy RemoteSigned
    >    ```
    > 4. 確認メッセージが表示されたら `Y` を入力してEnterキーを押します。
    > 
    > この後、通常のPowerShellウィンドウに戻り、再度 `.\.venv\Scripts\activate` を実行してください。
実行後、コマンドプロンプトの行頭に `(.venv)` と表示されればOKです。

#### 1-4. 必要なライブラリのインストール (Mac / Windows共通)
仮想環境が有効な状態で、自動化に必要なライブラリとブラウザをインストールします。
```sh
# Mac / Windows 共通
pip install flet playwright
playwright install
```

#### 1-5. 設定ファイルの準備
`app.py`ファイル内の設定を変更します。

```python
# ①：あなたの緊急連絡先(電話番号)に書き換えてください
EMERGENCY_CONTACT = '090-1234-5678' 

# ②：追加したい時間帯 (8時〜22時でよければ変更不要)
HOURS_TO_ADD = list(range(8, 23)) 

# ③：主催団体向けか個人講師向けかの設定
# 主催団体向け講座の場合は True, 個人講師向け講座の場合は False に設定してください
IS_ORGANIZER = True
```

【重要】 `app.py`を開き、先頭部分の**設定項目（`EMERGENCY_CONTACT`, `IS_ORGANIZER`）**を自分の情報に必ず書き換えてください。

---

### ステップ2：【初回のみ】認証情報ファイルを作成する

1.  **仮想環境を有効化**します。（「1-3. 仮想環境の作成と有効化 (Mac / Windows共通)」の②）
2.  `python app.py` を実行してツールを起動します。
3.  ウィンドウが表示されたら、一番上にある【ログイン / 認証情報を作成 (初回のみ)】ボタンをクリックします。
4.  ブラウザが起動するので、**手動でストアカにログイン**してください。
5.  ログインが完了すると、ブラウザは自動で閉じ、ツール画面の「未認証」という表示が【認証済み】に変わります。これで認証は完了です。

---

### ステップ3：【実行】自動化ツールを動かす

1.  `python app.py` でツールを起動します（仮想環境の有効化を忘れずに）。
2.  **日程を追加する場合**:
    *   **個別日程追加**の場合:
        - 「個別日程追加」を選択します。
        - 日程リストに、**タブ区切り**で `講座名`, `講座ID`, `日付`, `時間`, `定員`, `料金`, `締切`, `連絡先` を入力します。
        - 【個別日程追加】ボタンをクリックします。
    *   **連続日程追加**の場合:
        - 「連続日程追加」を選択します。
        - 【日程追加ページのURL】と【緊急連絡先】が正しいか確認・修正します。
        - 追加したい【開始日】と【終了日】を`YYYY-MM-DD`形式で入力します。
        - 【連続日程追加】ボタンをクリックします。
3.  **日程を削除する場合**:
    *   **個別日程削除**の場合:
        - 「個別日程削除」を選択
        - 削除したい講座名を入力
        - 削除したい日程リストを入力（例: `2025-08-27 14:00`）
        - 【個別日程削除】ボタンをクリック
    *   **連続日程削除**の場合:
        - 「連続日程削除」を選択
        - 削除したい講座名を入力
        - 削除したい【開始日】と【終了日】を入力
        - 【連続日程削除】ボタンをクリック（期間内の指定講座の全日程を削除）

実行すると、ブラウザが自動で立ち上がり、処理が開始されます。下部の「実行ログ」に進捗が表示されます。

---

### （補足）仮想環境を終了するには

すべての作業が終わった後、ターミナルの行頭にある `(.venv)` の表示を消して元の状態に戻したい場合は、以下のコマンドを実行します。

```sh
deactivate
```

---

## 日常的な使い方（2回目以降の作業）

初回セットアップが完了していれば、次回からはこの手順だけでツールを使えます。

### ステップ1：ツールの起動

1.  **ターミナル**（Windowsの場合は**コマンドプロンプト**）を開きます。
2.  `cd` コマンドで、前回クローンした `street_academy_automation` フォルダに移動します。
    ```sh
    # 例
    cd ~/Desktop/street_academy_automation
    ```
3.  **仮想環境を有効化**します。
    *   **Mac の場合:**
        ```sh
        source .venv/bin/activate
        ```
    *   **Windows の場合:**
        ```powershell
        .\.venv\Scripts\activate
        ```
4.  ツールを起動します。
    *   **Mac の場合:** `python app.py`
    *   **Windows の場合:** `python app.py`

### ステップ2：日程の追加または削除

ツールが起動したら、あとは画面の指示に従って操作します。

*   **日程を追加する場合**:
    *   **個別日程追加**の場合:
        - 「個別日程追加」を選択します。
        - 日程リストに、**タブ区切り**で `講座名`, `講座ID`, `日付`, `時間`, `定員`, `料金`, `締切`, `連絡先` を入力します。
        - 【個別日程追加】ボタンをクリックします。
    *   **連続日程追加**の場合:
        - 「連続日程追加」を選択します。
        - 【日程追加ページのURL】と【緊急連絡先】が正しいか確認・修正します。
        - 追加したい【開始日】と【終了日】を`YYYY-MM-DD`形式で入力します。
        - 【連続日程追加】ボタンをクリックします。
*   **日程を削除する場合**:
    1.  **個別日程削除**の場合:
        - 「個別日程削除」を選択
        - 削除したい講座名を入力
        - 削除したい日程リストを入力（例: `2025-08-27 14:00`）
        - 【個別日程削除】ボタンをクリック
    2.  **連続日程削除**の場合:
        - 「連続日程削除」を選択
        - 削除したい講座名を入力
        - 削除したい【開始日】と【終了日】を入力
        - 【連続日程削除】ボタンをクリック（期間内の指定講座の全日程を削除）

実行するとブラウザが自動で動き出し、処理が終わると自動で閉じます。

### ステップ3：ツールの終了

1.  ツールウィンドウを閉じます。
2.  ターミナルで `deactivate` コマンドを実行して、仮想環境を終了します。
    ```sh
    deactivate
    ```
